[plugin]
id = "ac6"
name = "Armored Core VI: Fires of Rubicon"
short_name = "AC6"
version = "1.1.0"
author = "NYA Core"
description = "Armored Core VI autosplitter with mission tracking"
update_url = "https://raw.githubusercontent.com/valkyaha/NYA-Core-Assets/main/plugins/ac6/plugin.toml"

# Save file location for practice mode backup/restore
save_location_windows = "%APPDATA%/ArmoredCore6"
save_location_linux = "~/.local/share/Steam/userdata"
save_type = "folder"

[process]
names = ["armoredcore6.exe"]

# =============================================================================
# RECOMMENDED TOOLS
# =============================================================================

[[tools]]
name = "AC6 Save Manager"
description = "Backup and manage save files for Armored Core VI"
author = "Community"
version = "1.0.0"
download_url = "https://github.com/search?q=armored+core+6+save+manager"
category = "utility"
required = false

[autosplitter]
enabled = true
algorithm = "binary_tree"

# Binary tree algorithm configuration (AC6 style)
# Based on SoulSplitter by FrankvdStam
[autosplitter.tree_config]
primary_pattern = "cs_event_flag_man"
pointer_chain = []  # Direct access after RIP resolution
divisor_offset = 0x1c
tree_root_offset = 0x38
multiplier_offset = 0x20
base_addr_offset = 0x28

# Memory patterns for finding game data structures
# Based on SoulSplitter by FrankvdStam
# https://github.com/FrankvdStam/SoulSplitter

[[autosplitter.patterns]]
name = "cs_event_flag_man"
pattern = "48 8B 35 ? ? ? ? 83 F8 FF 0F 44 C1"
rip_offset = 3
instruction_len = 7
pointer_offsets = [0, 0]

[[autosplitter.patterns]]
name = "fd4_time"
pattern = "48 8B 0D ? ? ? ? 0F 28 C8 F3 0F 59 0D"
rip_offset = 3
instruction_len = 7
pointer_offsets = [0, 0]

[[autosplitter.patterns]]
name = "cs_menu_man"
pattern = "48 8B 35 ? ? ? ? 33 DB 89 5C 24 20"
rip_offset = 3
instruction_len = 7
pointer_offsets = [0, 0]

# =============================================================================
# POINTER CHAINS - Derived pointers from base patterns
# =============================================================================

[autosplitter.pointers]
# IGT from FD4Time
igt = { base = "fd4_time", offsets = [0, 0] }

# =============================================================================
# MEMORY LAYOUT - Offsets for reading values
# =============================================================================

[autosplitter.memory_layout]
# IGT offset (from IGT pointer)
igt_offset = 0x114

# Loading state check at CSMenuMan + 0x8E4
loading_offset = 0x8E4

# Event flag tree constants (same as Elden Ring)
[autosplitter.memory_layout.event_flag_tree]
divisor_offset = 0x1C
root_offset = 0x38
first_sub_element = 0x8
left_child = 0x0
right_child = 0x10
leaf_check_offset = 0x19
category_offset = 0x20
mystery_value_offset = 0x28
element_value_offset = 0x30
base_address_offset = 0x28

# =============================================================================
# MISSIONS (Chapter 1)
# =============================================================================

# Chapter 1 Missions
[[bosses]]
id = "illegal_entry"
name = "Illegal Entry"
location = "Rubicon - Chapter 1"
required = true
is_dlc = false
flag_id = 100100
order = 1

[[bosses]]
id = "destroy_artillery"
name = "Destroy the Artillery Installations"
location = "Grid 086 - Chapter 1"
required = true
is_dlc = false
flag_id = 100200
order = 2

[[bosses]]
id = "destroy_dam"
name = "Destroy the Dam Complex"
location = "Dam Complex - Chapter 1"
required = true
is_dlc = false
flag_id = 100300
order = 3

[[bosses]]
id = "wall_assault"
name = "Wall Assault (Strider)"
location = "Wall - Chapter 1"
required = true
is_dlc = false
flag_id = 100400
order = 4

[[bosses]]
id = "retrieve_combat_logs"
name = "Retrieve Combat Logs"
location = "Grid 012 - Chapter 1"
required = true
is_dlc = false
flag_id = 100500
order = 5

[[bosses]]
id = "attack_watchpoint"
name = "Attack the Watchpoint (AH12: HC Helicopter)"
location = "Watchpoint - Chapter 1"
required = true
is_dlc = false
flag_id = 100600
order = 6

[[bosses]]
id = "operation_wallclimber"
name = "Operation Wallclimber (Juggernaut)"
location = "Wall - Chapter 1"
required = true
is_dlc = false
flag_id = 100700
order = 7

[[bosses]]
id = "retrieve_survey_data"
name = "Retrieve Survey Data"
location = "Grid 135 - Chapter 1"
required = true
is_dlc = false
flag_id = 100800
order = 8

[[bosses]]
id = "infiltrate_grid_86"
name = "Infiltrate Grid 086 (Smart Cleaner)"
location = "Grid 086 - Chapter 1"
required = true
is_dlc = false
flag_id = 100900
order = 9

[[bosses]]
id = "attack_fuel_depot"
name = "Attack the Fuel Depot (Balteus)"
location = "Grid 012 - Chapter 1"
required = true
is_dlc = false
flag_id = 101000
order = 10

# Chapter 2 Missions
[[bosses]]
id = "investigate_watcher"
name = "Investigate BAWS Arsenal No. 2"
location = "Arsenal - Chapter 2"
required = true
is_dlc = false
flag_id = 200100
order = 11

[[bosses]]
id = "ocean_crossing"
name = "Ocean Crossing"
location = "Ocean - Chapter 2"
required = true
is_dlc = false
flag_id = 200200
order = 12

[[bosses]]
id = "steal_survey_data"
name = "Steal the Survey Data"
location = "Central Ice Field - Chapter 2"
required = true
is_dlc = false
flag_id = 200300
order = 13

[[bosses]]
id = "attack_mining_ship"
name = "Attack the Mining Ship (Strider)"
location = "Mining Ship - Chapter 2"
required = true
is_dlc = false
flag_id = 200400
order = 14

[[bosses]]
id = "tunnel_sabotage"
name = "Tunnel Sabotage (IA-13: Sea Spider)"
location = "Tunnel - Chapter 2"
required = true
is_dlc = false
flag_id = 200500
order = 15

# Chapter 3 Missions
[[bosses]]
id = "destroy_special_forces"
name = "Destroy Special Forces Craft (V.III O'Keeffe)"
location = "Xylem - Chapter 3"
required = true
is_dlc = false
flag_id = 300100
order = 16

[[bosses]]
id = "stop_corporate_craft"
name = "Stop the Corporate Craft"
location = "Stratosphere - Chapter 3"
required = true
is_dlc = false
flag_id = 300200
order = 17

[[bosses]]
id = "destroy_ice_worm"
name = "Destroy the Ice Worm (Ice Worm)"
location = "Ice Field - Chapter 3"
required = true
is_dlc = false
flag_id = 300300
order = 18

[[bosses]]
id = "escort_survey_team"
name = "Escort Survey Team"
location = "Central Ice Field - Chapter 3"
required = true
is_dlc = false
flag_id = 300400
order = 19

[[bosses]]
id = "attack_old_spaceport"
name = "Attack the Old Spaceport (Ibis)"
location = "Old Spaceport - Chapter 3"
required = true
is_dlc = false
flag_id = 300500
order = 20

# Chapter 4 Missions
[[bosses]]
id = "underground_exploration1"
name = "Underground Exploration - Depth 1"
location = "Underground - Chapter 4"
required = true
is_dlc = false
flag_id = 400100
order = 21

[[bosses]]
id = "underground_exploration2"
name = "Underground Exploration - Depth 2 (Ephemera)"
location = "Underground - Chapter 4"
required = true
is_dlc = false
flag_id = 400200
order = 22

[[bosses]]
id = "underground_exploration3"
name = "Underground Exploration - Depth 3 (Cel 240)"
location = "Underground - Chapter 4"
required = true
is_dlc = false
flag_id = 400300
order = 23

[[bosses]]
id = "reach_coral_convergence"
name = "Reach the Coral Convergence"
location = "Convergence - Chapter 4"
required = true
is_dlc = false
flag_id = 400400
order = 24

[[bosses]]
id = "take_coral_convergence"
name = "Take the Coral Convergence (Arquebus Balteus)"
location = "Convergence - Chapter 4"
required = true
is_dlc = false
flag_id = 400500
order = 25

# Chapter 5 Missions
[[bosses]]
id = "ambush_vespers"
name = "Ambush the Vespers"
location = "Grid 135 - Chapter 5"
required = true
is_dlc = false
flag_id = 500100
order = 26

[[bosses]]
id = "eliminate_v_iii"
name = "Eliminate V.III (V.III O'Keeffe)"
location = "Chapter 5"
required = true
is_dlc = false
flag_id = 500200
order = 27

[[bosses]]
id = "unknown_territory"
name = "Unknown Territory Survey"
location = "Chapter 5"
required = true
is_dlc = false
flag_id = 500300
order = 28

[[bosses]]
id = "intercept_redguns"
name = "Intercept the Redguns (G1 Michigan)"
location = "Chapter 5"
required = true
is_dlc = false
flag_id = 500400
order = 29

[[bosses]]
id = "eliminate_cinder_carla"
name = "Eliminate Cinder Carla"
location = "Chapter 5"
required = true
is_dlc = false
flag_id = 500500
order = 30

[[bosses]]
id = "bring_down_xylem"
name = "Bring Down the Xylem (ALLMIND)"
location = "Xylem - Chapter 5"
required = true
is_dlc = false
flag_id = 500600
order = 31

# Final Boss (varies by ending)
[[bosses]]
id = "fires_raven"
name = "Fires of Raven Ending (Ayre)"
location = "Xylem"
required = false
is_dlc = false
flag_id = 600100
order = 32

[[bosses]]
id = "liberator_carla"
name = "Liberator of Rubicon Ending (Handler Walter)"
location = "Xylem"
required = false
is_dlc = false
flag_id = 600200
order = 33

[[bosses]]
id = "alea_iacta_est"
name = "Alea Iacta Est Ending (ALLMIND)"
location = "Xylem"
required = false
is_dlc = false
flag_id = 600300
order = 34

# Presets
[[presets]]
id = "any-percent"
name = "Any%"
description = "Main story missions"
boss_ids = [
    "illegal_entry", "destroy_artillery", "destroy_dam", "wall_assault",
    "retrieve_combat_logs", "attack_watchpoint", "operation_wallclimber",
    "retrieve_survey_data", "infiltrate_grid_86", "attack_fuel_depot",
    "investigate_watcher", "ocean_crossing", "steal_survey_data",
    "attack_mining_ship", "tunnel_sabotage", "destroy_special_forces",
    "stop_corporate_craft", "destroy_ice_worm", "escort_survey_team",
    "attack_old_spaceport", "underground_exploration1", "underground_exploration2",
    "underground_exploration3", "reach_coral_convergence", "take_coral_convergence",
    "ambush_vespers", "eliminate_v_iii", "unknown_territory", "intercept_redguns",
    "eliminate_cinder_carla", "bring_down_xylem"
]

[[presets]]
id = "all-endings"
name = "All Endings"
description = "Main story plus all three endings"
boss_ids = [
    "illegal_entry", "destroy_artillery", "destroy_dam", "wall_assault",
    "retrieve_combat_logs", "attack_watchpoint", "operation_wallclimber",
    "retrieve_survey_data", "infiltrate_grid_86", "attack_fuel_depot",
    "investigate_watcher", "ocean_crossing", "steal_survey_data",
    "attack_mining_ship", "tunnel_sabotage", "destroy_special_forces",
    "stop_corporate_craft", "destroy_ice_worm", "escort_survey_team",
    "attack_old_spaceport", "underground_exploration1", "underground_exploration2",
    "underground_exploration3", "reach_coral_convergence", "take_coral_convergence",
    "ambush_vespers", "eliminate_v_iii", "unknown_territory", "intercept_redguns",
    "eliminate_cinder_carla", "bring_down_xylem",
    "fires_raven", "liberator_carla", "alea_iacta_est"
]
